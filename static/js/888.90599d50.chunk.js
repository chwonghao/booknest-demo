"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[888],{1819:(e,t,a)=>{a.d(t,{OL:()=>i,Qt:()=>o,ZS:()=>d,zr:()=>n});var s=a(2554),r=a(4512);const n=async e=>{const t=e,a=e.orderItems;try{for(const e of a){const t=await(0,s.yj)(e.productId);await(0,s.NM)(e.productId,t.stockQuantity-e.quantity)}}catch(n){console.error(n)}return await r.A.post("/orders",t)},o=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(await r.A.get("/orders/user/".concat(e),{params:t})).data},d=async()=>(await r.A.get("/orders")).data,i=async(e,t)=>{try{return(await r.A.patch("/orders/".concat(e),{status:t})).data}catch(s){var a;throw console.error("Error updating order status for order ".concat(e,":"),s.response||s),(null===(a=s.response)||void 0===a?void 0:a.data)||new Error("Failed to update order status")}}},2078:(e,t,a)=>{a.d(t,{J:()=>r,N:()=>n});var s=a(4512);const r=async()=>(await s.A.get("/users")).data,n=async(e,t)=>(await s.A.patch("/users/".concat(e),t)).data},4888:(e,t,a)=>{a.r(t),a.d(t,{default:()=>U});var s=a(5043),r=a(3336),n=a(1045),o=a(6446),d=a(5865),i=a(1637),l=a(4194),c=a(8903),x=a(5721),m=a(681),h=a(8734),u=a(9336),g=a(95),A=a(379),j=a(1180),y=a(7869),v=a(6102),p=a(5353),f=a(3331),w=a(2185),D=a(6026),b=a(1474),P=a(6992),E=a(3192),L=a(1334),S=a(7991),k=a(2807),I=a(6559),C=a(6710),N=a(1819),F=a(2078),O=a(2554),R=a(4117),T=a(579);const B=e=>{let{icon:t,title:a,value:s,color:l,loading:c}=e;return(0,T.jsxs)(r.A,{sx:{p:2,display:"flex",alignItems:"center",height:"100%"},children:[(0,T.jsx)(n.A,{sx:{bgcolor:l,mr:2},children:t}),(0,T.jsxs)(o.A,{children:[(0,T.jsx)(d.A,{color:"text.secondary",children:a}),(0,T.jsx)(d.A,{variant:"h5",component:"p",fontWeight:"bold",children:c?(0,T.jsx)(i.A,{size:20}):s})]})]})},Q={PENDING:"#FFC107",CONFIRMED:"#9C27B0",PAID:"#03A9F4",SHIPPED:"#2196F3",DELIVERED:"#8BC34A",COMPLETED:"#4CAF50",CANCELLED:"#F44336",RETURNED:"#607D8B",REFUNDED:"#795548",DEFAULT:"#9E9E9E"},U=()=>{var e,t,a,U,G,H,K,M;const[W,q]=(0,s.useState)(null),[z,J]=(0,s.useState)(!0),[Z,$]=(0,s.useState)(null),{t:V}=(0,R.Bd)();return(0,s.useEffect)(()=>{(async()=>{try{J(!0);const e=await(0,N.ZS)(),t=await(0,F.J)(),a=new Date;a.setDate(a.getDate()-30);const s=t.filter(e=>{const t=new Date(e.createdAt);return"USER"===e.role&&t>a}).length,r=await(0,O.eN)(),n=r.reduce((e,t)=>e+(t.stockQuantity||0),0),o=r.filter(e=>e.stockQuantity<10).sort((e,t)=>e.stockQuantity-t.stockQuantity),d=e.reduce((e,t)=>(e[t.status]=(e[t.status]||0)+1,e),{}),i=Object.keys(d).map(e=>({name:e,value:d[e]})),l={totalRevenue:e.filter(e=>"COMPLETED"===e.status).reduce((e,t)=>e+t.totalAmount,0),totalOrders:e.length,newCustomers:s,productsInStock:n},c=[{name:"T2",sales:4e3},{name:"T3",sales:3e3},{name:"T4",sales:2e3},{name:"T5",sales:2780},{name:"T6",sales:1890},{name:"T7",sales:2390},{name:"CN",sales:3490}];await new Promise(e=>setTimeout(e,1e3));const x=e.sort((e,t)=>new Date(t.createdAt)-new Date(e.createdAt)).slice(0,5),m=t.filter(e=>e.lastLogin).sort((e,t)=>new Date(t.lastLogin)-new Date(e.lastLogin)).slice(0,5);q({summaryData:l,salesData:c,recentOrders:x,lowStockProducts:o,orderStatusData:i,recentLogins:m}),$(null)}catch(e){console.error("Failed to fetch dashboard data:",e),$(V("admin.dashboardPage.fetchError")),q(null)}finally{J(!1)}})()},[V]),Z?(0,T.jsx)(l.A,{severity:"error",children:Z}):(0,T.jsxs)(o.A,{sx:{flexGrow:1},children:[(0,T.jsx)(d.A,{variant:"h4",gutterBottom:!0,component:"h1",fontWeight:"bold",children:V("admin.dashboardPage.title")}),(0,T.jsxs)(c.Ay,{container:!0,spacing:3,pb:10,children:[(0,T.jsx)(c.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,T.jsx)(B,{icon:(0,T.jsx)(E.A,{}),title:V("admin.dashboardPage.totalRevenue"),value:null!==W&&void 0!==W&&null!==(e=W.summaryData)&&void 0!==e&&e.totalRevenue?"$".concat(W.summaryData.totalRevenue.toLocaleString()):"N/A",color:"success.main",loading:z})}),(0,T.jsx)(c.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,T.jsx)(B,{icon:(0,T.jsx)(L.A,{}),title:V("admin.dashboardPage.totalOrders"),value:null!==(t=null===W||void 0===W||null===(a=W.summaryData)||void 0===a?void 0:a.totalOrders)&&void 0!==t?t:"N/A",color:"info.main",loading:z})}),(0,T.jsx)(c.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,T.jsx)(B,{icon:(0,T.jsx)(S.A,{}),title:V("admin.dashboardPage.newCustomers"),value:null!==(U=null===W||void 0===W||null===(G=W.summaryData)||void 0===G?void 0:G.newCustomers)&&void 0!==U?U:"N/A",color:"warning.main",loading:z})}),(0,T.jsx)(c.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,T.jsx)(B,{icon:(0,T.jsx)(C.A,{}),title:V("admin.dashboardPage.productsInStock"),value:null!==(H=null===W||void 0===W||null===(K=W.summaryData)||void 0===K?void 0:K.productsInStock)&&void 0!==H?H:"N/A",color:"error.main",loading:z})}),(0,T.jsx)(c.Ay,{item:!0,xs:12,md:8,children:(0,T.jsxs)(r.A,{sx:{p:2,display:"flex",flexDirection:"column",height:400},children:[(0,T.jsx)(d.A,{variant:"h6",gutterBottom:!0,children:V("admin.dashboardPage.weeklyRevenue")}),z?(0,T.jsx)(o.A,{sx:{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,T.jsx)(i.A,{})}):(0,T.jsx)(j.u,{width:"100%",height:"90%",children:(0,T.jsxs)(b.E,{data:(null===W||void 0===W?void 0:W.salesData)||[],margin:{top:5,right:20,left:-10,bottom:-10},children:[(0,T.jsx)(p.d,{strokeDasharray:"3 3"}),(0,T.jsx)(w.W,{dataKey:"name"}),(0,T.jsx)(D.h,{}),(0,T.jsx)(A.m,{}),(0,T.jsx)(g.s,{}),(0,T.jsx)(f.yP,{dataKey:"sales",fill:"#8884d8",name:V("admin.dashboardPage.sales")})]})})]})}),(0,T.jsx)(c.Ay,{item:!0,xs:12,md:4,children:(0,T.jsxs)(r.A,{sx:{p:2,display:"flex",flexDirection:"column",height:400},children:[(0,T.jsx)(d.A,{variant:"h6",gutterBottom:!0,children:V("admin.dashboardPage.orderStatusRatio")}),z?(0,T.jsx)(o.A,{sx:{flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,T.jsx)(i.A,{})}):(0,T.jsx)(o.A,{sx:{width:"100%",flexGrow:1},children:(0,T.jsx)(j.u,{width:"100%",height:"100%",children:(0,T.jsxs)(P.r,{children:[(0,T.jsx)(v.Fq,{data:(null===W||void 0===W?void 0:W.orderStatusData)||[],cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",nameKey:"name",children:null===W||void 0===W||null===(M=W.orderStatusData)||void 0===M?void 0:M.map((e,t)=>(0,T.jsx)(y.f,{fill:Q[e.name]||Q.DEFAULT},"cell-".concat(t)))}),(0,T.jsx)(A.m,{}),(0,T.jsx)(g.s,{})]})})})]})}),(0,T.jsx)(c.Ay,{item:!0,xs:12,md:6,children:(0,T.jsxs)(r.A,{sx:{p:2,height:"100%"},children:[(0,T.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,T.jsx)(I.A,{color:"warning",sx:{mr:1}}),(0,T.jsx)(d.A,{variant:"h6",gutterBottom:!0,component:"div",sx:{mb:0},children:V("admin.dashboardPage.lowStockProducts")})]}),z?(0,T.jsx)(i.A,{}):(0,T.jsx)(x.A,{dense:!0,sx:{maxHeight:300,overflow:"auto"},children:null!==W&&void 0!==W&&W.lowStockProducts&&W.lowStockProducts.length>0?W.lowStockProducts.map(e=>(0,T.jsx)(m.Ay,{divider:!0,children:(0,T.jsx)(h.A,{primary:e.name,secondaryTypographyProps:{color:"error.main",fontWeight:"bold"},secondary:V("admin.dashboardPage.onlyLeft",{count:e.stockQuantity})})},e.id)):(0,T.jsx)(d.A,{sx:{p:2,color:"text.secondary"},children:V("admin.dashboardPage.noLowStockProducts")})})]})}),(0,T.jsx)(c.Ay,{item:!0,xs:12,md:6,children:(0,T.jsxs)(r.A,{sx:{p:2,height:"100%"},children:[(0,T.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,T.jsx)(k.A,{color:"info",sx:{mr:1}}),(0,T.jsx)(d.A,{variant:"h6",gutterBottom:!0,component:"div",sx:{mb:0},children:V("admin.dashboardPage.recentLogins")})]}),z?(0,T.jsx)(i.A,{}):(0,T.jsx)(x.A,{dense:!0,sx:{maxHeight:300,overflow:"auto"},children:null!==W&&void 0!==W&&W.recentLogins&&W.recentLogins.length>0?W.recentLogins.map(e=>(0,T.jsxs)(m.Ay,{divider:!0,children:[(0,T.jsx)(n.A,{sx:{mr:2},src:e.avatarUrl}),(0,T.jsx)(h.A,{primary:e.fullName,secondary:"".concat(V("admin.dashboardPage.loggedInAt")).concat(new Date(e.lastLogin).toLocaleString())})]},e.id)):(0,T.jsx)(d.A,{sx:{p:2,color:"text.secondary"},children:V("admin.dashboardPage.noRecentLogins")})})]})}),(0,T.jsx)(c.Ay,{item:!0,xs:12,children:(0,T.jsxs)(r.A,{sx:{p:2,height:"100%"},children:[(0,T.jsx)(d.A,{variant:"h6",gutterBottom:!0,children:V("admin.dashboardPage.recentOrders")}),z?(0,T.jsx)(i.A,{}):(0,T.jsx)(x.A,{dense:!0,sx:{maxHeight:300,overflow:"auto"},children:null!==W&&void 0!==W&&W.recentOrders&&W.recentOrders.length>0?W.recentOrders.map((e,t)=>(0,T.jsxs)(s.Fragment,{children:[(0,T.jsx)(m.Ay,{alignItems:"flex-start",children:(0,T.jsx)(h.A,{primary:"".concat(V("admin.dashboardPage.order")," #").concat(e.id," - ").concat(e.userName),secondary:"$".concat(e.totalAmount.toFixed(2)," - ").concat(new Date(e.createdAt).toLocaleDateString())})}),t<W.recentOrders.length-1&&(0,T.jsx)(u.A,{component:"li"})]},e.id)):(0,T.jsx)(d.A,{sx:{p:2,color:"text.secondary"},children:V("admin.dashboardPage.noRecentOrders")})})]})})]})]})}}}]);
//# sourceMappingURL=888.90599d50.chunk.js.map