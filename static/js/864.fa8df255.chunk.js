"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[864],{1819:(e,t,r)=>{r.d(t,{OL:()=>c,Qt:()=>l,ZS:()=>d,zr:()=>o});var n=r(2554);let s=[{id:101,userId:1,orderDate:new Date("2023-10-26T10:00:00Z").toISOString(),status:"DELIVERED",totalAmount:229e3,shippingAddress:{fullName:"Ng\u01b0\u1eddi D\xf9ng Demo",address:"123 \u0110\u01b0\u1eddng ABC, Qu\u1eadn 1, TP. HCM",phoneNumber:"0123456789"},orderItems:[{productId:1,name:"L\u01b0\u1ee3c S\u1eed Lo\xe0i Ng\u01b0\u1eddi",quantity:1,price:15e4},{productId:2,name:"Nh\xe0 Gi\u1ea3 Kim",quantity:1,price:79e3}]},{id:102,userId:1,orderDate:new Date("2023-10-28T14:30:00Z").toISOString(),status:"PENDING",totalAmount:165e3,shippingAddress:{fullName:"Ng\u01b0\u1eddi D\xf9ng Demo",address:"123 \u0110\u01b0\u1eddng ABC, Qu\u1eadn 1, TP. HCM",phoneNumber:"0123456789"},orderItems:[{productId:4,name:"Sapiens: L\u01b0\u1ee3c S\u1eed T\u01b0\u01a1ng Lai",quantity:1,price:165e3}]}],a=103;const i=e=>new Promise(t=>setTimeout(t,e)),o=async e=>{await i(1e3),console.log("MOCK: createOrderApi",e);try{for(const t of e.orderItems){const e=await(0,n.yj)(t.productId);await(0,n.NM)(t.productId,e.stockQuantity-t.quantity)}}catch(r){throw console.error("MOCK: L\u1ed7i tr\u1eeb kho khi t\u1ea1o \u0111\u01a1n h\xe0ng",r),new Error("Kh\xf4ng th\u1ec3 c\u1eadp nh\u1eadt kho, \u0111\u01a1n h\xe0ng ch\u01b0a \u0111\u01b0\u1ee3c t\u1ea1o.")}const t={id:a++,userId:e.userId,orderDate:(new Date).toISOString(),status:"PENDING",totalAmount:e.totalAmount,orderItems:e.orderItems,shippingAddress:e.shippingAddress};return s.push(t),{data:t}},l=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await i(500),console.log("MOCK: getMyOrdersApi for user ".concat(e),{params:t}),s.filter(t=>t.userId.toString()===e.toString())},d=async()=>(await i(500),console.log("MOCK: getAllOrdersApi"),[...s]),c=async(e,t)=>{await i(300),console.log("MOCK: updateOrderStatusApi for order ".concat(e," to status ").concat(t));const r=s.find(t=>t.id.toString()===e.toString());if(r)return r.status=t,r;throw new Error("Order not found")}},1864:(e,t,r)=>{r.r(t),r.d(t,{default:()=>O});var n=r(9379),s=r(5043),a=r(6446),i=r(1637),o=r(9252),l=r(5865),d=r(1906),c=r(8903),u=r(3336),h=r(5795),m=r(3193),x=r(1292),p=r(7972),A=r(4605),g=r(4791),j=r(9336),y=r(5721),f=r(681),b=r(8734),v=r(4117),I=r(8163),N=r(2603),C=r(8036),S=r(7488),k=r(2452),w=r(1819),D=r(579);const O=()=>{const{t:e,i18n:t}=(0,v.Bd)(),r=(0,I.Zp)(),{items:O,total:W,clearCart:q}=(0,s.useContext)(N.M),{user:M,isAuthenticated:E,loading:P}=(0,s.useContext)(C.c),[L,B]=(0,s.useState)({fullName:(null===M||void 0===M?void 0:M.fullName)||"",address:(null===M||void 0===M?void 0:M.address)||"",phoneNumber:(null===M||void 0===M?void 0:M.phoneNumber)||"",email:(null===M||void 0===M?void 0:M.email)||""}),[K,R]=(0,s.useState)("cod"),[T,z]=(0,s.useState)(!1),G=e=>{if(null===e||void 0===e)return"";if("vi"===t.language.split("-")[0]){return"".concat((25e3*e).toLocaleString("vi-VN")," \u20ab")}return"$".concat(e.toFixed(2))};(0,s.useEffect)(()=>{P||E||(S.oR.info(e("cart.summary.loginPrompt")),r("/login",{state:{from:"/checkout"},replace:!0}))},[E,P,r,e]);const Q=e=>{B((0,n.A)((0,n.A)({},L),{},{[e.target.name]:e.target.value}))};return P||!E?(0,D.jsx)(a.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh"},children:(0,D.jsx)(i.A,{})}):0===O.length?(0,D.jsxs)(o.A,{sx:{textAlign:"center",mt:8},children:[(0,D.jsx)(l.A,{variant:"h5",children:e("checkout.noItems")}),(0,D.jsx)(d.A,{variant:"contained",sx:{mt:2},onClick:()=>r("/"),children:e("cart.continueShopping")})]}):(0,D.jsxs)(o.A,{maxWidth:"lg",sx:{mt:4,mb:4},children:[(0,D.jsx)(k.A,{links:[{label:e("breadcrumbs.checkout")}],sx:{mb:3}}),(0,D.jsx)(l.A,{variant:"h4",component:"h1",gutterBottom:!0,fontWeight:"bold",children:e("checkout.title")}),(0,D.jsx)("form",{onSubmit:async t=>{t.preventDefault(),z(!0);try{const t={userId:M.id,userName:M.fullName,orderItems:O.map(e=>({productId:e.id,quantity:e.qty})),totalAmount:W,status:"PENDING"};await(0,w.zr)(t),S.oR.success(e("checkout.orderPlacedSuccess")),q(),r("/cart")}catch(a){var n,s;console.error("Failed to place order:",a),S.oR.error((null===(n=a.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.message)||"Failed to place order. Please try again.")}finally{z(!1)}},children:(0,D.jsxs)(c.Ay,{container:!0,spacing:4,children:[(0,D.jsxs)(c.Ay,{item:!0,xs:12,md:7,children:[(0,D.jsxs)(u.A,{variant:"outlined",sx:{p:3,borderRadius:2},children:[(0,D.jsx)(l.A,{variant:"h6",gutterBottom:!0,children:e("checkout.shippingInfo")}),(0,D.jsxs)(c.Ay,{container:!0,spacing:2,children:[(0,D.jsx)(c.Ay,{item:!0,xs:12,children:(0,D.jsx)(h.A,{required:!0,fullWidth:!0,name:"fullName",label:e("register.fullName"),value:L.fullName,onChange:Q})}),(0,D.jsx)(c.Ay,{item:!0,xs:12,children:(0,D.jsx)(h.A,{required:!0,fullWidth:!0,name:"address",label:e("register.address"),value:L.address,onChange:Q})}),(0,D.jsx)(c.Ay,{item:!0,xs:12,sm:6,children:(0,D.jsx)(h.A,{required:!0,fullWidth:!0,name:"phoneNumber",label:e("register.phoneNumber"),value:L.phoneNumber,onChange:Q})}),(0,D.jsx)(c.Ay,{item:!0,xs:12,sm:6,children:(0,D.jsx)(h.A,{required:!0,fullWidth:!0,name:"email",type:"email",label:e("register.email"),value:L.email,onChange:Q})})]})]}),(0,D.jsx)(u.A,{variant:"outlined",sx:{p:3,mt:4,borderRadius:2},children:(0,D.jsxs)(m.A,{component:"fieldset",children:[(0,D.jsx)(x.A,{component:"legend",sx:{mb:1,fontWeight:"bold",color:"text.primary"},children:e("checkout.paymentMethod")}),(0,D.jsxs)(p.A,{row:!0,name:"paymentMethod",value:K,onChange:e=>R(e.target.value),children:[(0,D.jsx)(A.A,{value:"cod",control:(0,D.jsx)(g.A,{}),label:e("checkout.cod")}),(0,D.jsx)(A.A,{value:"paypal",control:(0,D.jsx)(g.A,{}),label:e("checkout.paypal"),disabled:!0})]})]})})]}),(0,D.jsx)(c.Ay,{item:!0,xs:12,md:5,children:(0,D.jsxs)(u.A,{variant:"outlined",sx:{p:3,position:"sticky",top:88,borderRadius:2},children:[(0,D.jsx)(l.A,{variant:"h6",gutterBottom:!0,children:e("cart.summary.title")}),(0,D.jsx)(j.A,{}),(0,D.jsx)(y.A,{children:O.map(e=>(0,D.jsxs)(f.Ay,{disableGutters:!0,children:[(0,D.jsx)(b.A,{primary:"".concat(e.name," (x").concat(e.qty,")"),secondary:Array.isArray(e.authors)&&e.authors.length>0?e.authors.map(e=>e.name).join(", "):""}),(0,D.jsx)(l.A,{variant:"body2",children:G(e.price*e.qty)})]},e.id))}),(0,D.jsx)(j.A,{}),(0,D.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",my:2},children:[(0,D.jsx)(l.A,{children:e("cart.summary.subtotal",{count:O.length})}),(0,D.jsx)(l.A,{fontWeight:"bold",children:G(W)})]}),(0,D.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[(0,D.jsx)(l.A,{children:e("cart.summary.shipping")}),(0,D.jsx)(l.A,{fontWeight:"bold",children:e("cart.summary.free")})]}),(0,D.jsx)(j.A,{}),(0,D.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",mt:2,mb:3},children:[(0,D.jsx)(l.A,{variant:"h5",fontWeight:"bold",children:e("cart.summary.total")}),(0,D.jsx)(l.A,{variant:"h5",fontWeight:"bold",children:G(W)})]}),(0,D.jsx)(d.A,{type:"submit",fullWidth:!0,variant:"contained",size:"large",disabled:T,children:T?(0,D.jsx)(i.A,{size:26,color:"inherit"}):e("checkout.placeOrder")})]})})]})})]})}},2452:(e,t,r)=>{r.d(t,{A:()=>u});r(5043);var n=r(9252),s=r(2698),a=r(5865),i=r(8446),o=r(8163),l=r(4117),d=r(3639),c=r(579);const u=e=>{let{links:t=[]}=e;const{t:r}=(0,l.Bd)(),u=[{to:"/",label:r("breadcrumbs.home"),icon:(0,c.jsx)(d.A,{sx:{mr:2,fontSize:"inherit"}})},...t];return(0,c.jsx)(n.A,{maxWidth:"lg",sx:{pt:0,pb:{xs:1,md:2}},children:(0,c.jsx)(s.A,{"aria-label":"breadcrumb",children:u.map((e,t)=>t===u.length-1?(0,c.jsxs)(a.A,{color:"text.primary",sx:{display:"flex",alignItems:"center"},children:[e.icon,e.label]},t):(0,c.jsxs)(i.A,{component:o.N_,to:e.to,underline:"hover",color:"inherit",sx:{display:"flex",alignItems:"center"},children:[e.icon,e.label]},t))})})}}}]);
//# sourceMappingURL=864.fa8df255.chunk.js.map