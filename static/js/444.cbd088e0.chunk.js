"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[444],{2078:(e,a,s)=>{s.d(a,{J:()=>l,N:()=>t});var n=s(4512);const l=async()=>(await n.A.get("/users")).data,t=async(e,a)=>(await n.A.patch("/users/".concat(e),a)).data},8444:(e,a,s)=>{s.r(a),s.d(a,{default:()=>U});var n=s(9379),l=s(5043),t=s(6446),r=s(5865),i=s(9650),c=s(1806),d=s(4882),o=s(8076),u=s(2420),m=s(3460),h=s(1045),x=s(3845),A=s(3336),j=s(1637),g=s(4194),f=s(35),p=s(6600),v=s(2935),y=s(8903),C=s(5795),b=s(3193),M=s(8356),N=s(9285),P=s(2143),S=s(9347),k=s(1906),E=s(7488),I=s(2078),w=s(6106),D=s(4117),R=s(579);const W=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split(" ").map(e=>e[0]).join("").toUpperCase()},L=e=>{let{users:a,title:s,onRowClick:n,t:l}=e;return(0,R.jsxs)(t.A,{sx:{mb:4},children:[(0,R.jsx)(r.A,{variant:"h5",gutterBottom:!0,component:"h2",children:s}),(0,R.jsx)(i.A,{children:(0,R.jsxs)(c.A,{stickyHeader:!0,children:[(0,R.jsx)(d.A,{children:(0,R.jsxs)(o.A,{children:[(0,R.jsx)(u.A,{sx:{width:"10%"},children:l("profile.avatar")}),(0,R.jsx)(u.A,{children:l("register.fullName")}),(0,R.jsx)(u.A,{children:l("register.email")}),(0,R.jsx)(u.A,{align:"center",children:l("profile.settings")}),(0,R.jsx)(u.A,{children:l("profile.role")}),(0,R.jsx)(u.A,{children:l("productPage.published")}),(0,R.jsx)(u.A,{children:l("admin.dashboardPage.recentLogins")})]})}),(0,R.jsx)(m.A,{children:a.map(e=>(0,R.jsxs)(o.A,{hover:!0,onClick:()=>n(e),sx:{cursor:"pointer"},children:[(0,R.jsx)(u.A,{children:(0,R.jsx)(h.A,{src:e.avatarUrl,children:W(e.fullName)})}),(0,R.jsx)(u.A,{children:e.fullName}),(0,R.jsx)(u.A,{children:e.email}),(0,R.jsx)(u.A,{align:"center",children:(0,R.jsx)(x.A,{label:e.status,color:"ACTIVE"===e.status?"success":"default",size:"small"})}),(0,R.jsx)(u.A,{children:(0,R.jsx)(x.A,{label:e.role,color:"ADMIN"===e.role?"secondary":"default",size:"small"})}),(0,R.jsx)(u.A,{children:new Date(e.createdAt).toLocaleDateString()}),(0,R.jsx)(u.A,{children:e.lastLogin?new Date(e.lastLogin).toLocaleString():"N/A"})]},e.id))})]})}),0===a.length&&(0,R.jsx)(r.A,{sx:{mt:2,textAlign:"center"},children:l("admin.userManagementPage.noUsersInCategory")})]})},U=()=>{const[e,a]=(0,l.useState)([]),[s,i]=(0,l.useState)(!0),[c,d]=(0,l.useState)(null),[o,u]=(0,l.useState)(!1),[m,h]=(0,l.useState)(null),[x,W]=(0,l.useState)(!1),[U,T]=(0,l.useState)(""),[B,F]=(0,l.useState)(""),[V,z]=(0,l.useState)(!1),{t:J}=(0,D.Bd)(),G=(0,l.useCallback)(async()=>{try{i(!0),d(null);const e=await(0,I.J)();a(e||[])}catch(e){d(J("admin.userManagementPage.fetchError")),a([]),console.error(e)}finally{i(!1)}},[J]);(0,l.useEffect)(()=>{G()},[G]);const{staff:H,customers:q}=(0,l.useMemo)(()=>({staff:e.filter(e=>"ADMIN"===e.role),customers:e.filter(e=>"USER"===e.role)}),[e]),K=e=>{h(e),u(!0)},O=()=>{u(!1),h(null),W(!1),T(""),F("")},Q=e=>{const{name:a,value:s}=e.target;h(e=>(0,n.A)((0,n.A)({},e),{},{[a]:s}))};return(0,R.jsxs)(A.A,{sx:{p:3,m:2},children:[(0,R.jsx)(r.A,{variant:"h4",gutterBottom:!0,children:J("admin.userManagementPage.title")}),s?(0,R.jsx)(t.A,{sx:{display:"flex",justifyContent:"center",my:5},children:(0,R.jsx)(j.A,{})}):c?(0,R.jsx)(g.A,{severity:"error",children:c}):(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(L,{users:H,title:J("admin.userManagementPage.staff"),onRowClick:K,t:J}),(0,R.jsx)(L,{users:q,title:J("admin.userManagementPage.customers"),onRowClick:K,t:J})]}),(0,R.jsxs)(f.A,{open:o,onClose:O,maxWidth:"sm",fullWidth:!0,disableScrollLock:!0,children:[(0,R.jsx)(p.A,{children:J("admin.userManagementPage.editUser")}),m&&(0,R.jsx)(v.A,{children:(0,R.jsxs)(y.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,R.jsx)(y.Ay,{item:!0,xs:12,children:(0,R.jsx)(C.A,{fullWidth:!0,label:J("register.fullName"),name:"fullName",value:m.fullName,disabled:!0})}),(0,R.jsx)(y.Ay,{item:!0,xs:12,children:(0,R.jsx)(C.A,{fullWidth:!0,label:J("register.email"),name:"email",value:m.email,disabled:!0})}),(0,R.jsx)(y.Ay,{item:!0,xs:12,children:(0,R.jsxs)(b.A,{fullWidth:!0,children:[(0,R.jsx)(M.A,{children:J("profile.settings")}),(0,R.jsxs)(N.A,{name:"status",value:m.status,label:J("profile.settings"),onChange:Q,MenuProps:{disableScrollLock:!0},children:[(0,R.jsx)(P.A,{value:"ACTIVE",children:"ACTIVE"}),(0,R.jsx)(P.A,{value:"INACTIVE",children:"INACTIVE"}),(0,R.jsx)(P.A,{value:"BANNED",children:"BANNED"})]})]})}),(0,R.jsx)(y.Ay,{item:!0,xs:12,children:(0,R.jsxs)(b.A,{fullWidth:!0,children:[(0,R.jsx)(M.A,{children:J("profile.role")}),(0,R.jsxs)(N.A,{name:"role",value:m.role,label:J("profile.role"),onChange:Q,MenuProps:{disableScrollLock:!0},children:[(0,R.jsx)(P.A,{value:"USER",children:"USER"}),(0,R.jsx)(P.A,{value:"ADMIN",children:"ADMIN"})]})]})})]})}),(0,R.jsxs)(S.A,{children:[(0,R.jsx)(k.A,{onClick:O,children:J("action.cancel")}),(0,R.jsx)(k.A,{onClick:()=>{u(!1),W(!0)},color:"primary",children:J("admin.userManagementPage.sendEmail")}),(0,R.jsx)(k.A,{onClick:async()=>{if(m)try{const{id:e,role:a,status:s}=m;await(0,I.N)(e,{role:a,status:s}),E.oR.success(J("admin.userManagementPage.updateSuccess")),O(),G()}catch(e){console.error("Failed to update user:",e),E.oR.error(J("admin.userManagementPage.updateError"))}},variant:"contained",children:J("profile.saveChanges")})]})]}),(0,R.jsxs)(f.A,{open:x,onClose:O,maxWidth:"md",fullWidth:!0,children:[(0,R.jsxs)(p.A,{children:[J("admin.userManagementPage.sendEmailTo")," ",null===m||void 0===m?void 0:m.fullName]}),(0,R.jsxs)(v.A,{children:[(0,R.jsxs)(r.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:[J("register.email"),": ",null===m||void 0===m?void 0:m.email]}),(0,R.jsx)(C.A,{autoFocus:!0,margin:"dense",id:"subject",label:J("admin.userManagementPage.emailSubject"),type:"text",fullWidth:!0,variant:"outlined",value:U,onChange:e=>T(e.target.value)}),(0,R.jsx)(C.A,{margin:"dense",id:"body",label:J("admin.userManagementPage.emailContent"),type:"text",fullWidth:!0,multiline:!0,rows:8,variant:"outlined",value:B,onChange:e=>F(e.target.value)})]}),(0,R.jsxs)(S.A,{children:[(0,R.jsx)(k.A,{onClick:O,children:J("action.cancel")}),(0,R.jsx)(k.A,{onClick:async()=>{if(m&&U&&B){z(!0);try{const e={userId:m.id,subject:U,message:B,type:"EMAIL",status:"PENDING"};await(0,w.D)(e),E.oR.success("".concat(J("admin.userManagementPage.emailSentSuccess")," ").concat(m.fullName)),O()}catch(e){console.error("Failed to send email:",e),E.oR.error(J("admin.userManagementPage.emailSentError"))}finally{z(!1)}}else E.oR.warn(J("admin.userManagementPage.emailFormInvalid"))},variant:"contained",disabled:V,children:J(V?"admin.userManagementPage.sending":"admin.userManagementPage.send")})]})]})]})}}}]);
//# sourceMappingURL=444.cbd088e0.chunk.js.map