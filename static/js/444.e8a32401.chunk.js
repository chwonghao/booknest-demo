"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[444],{2078:(e,a,s)=>{s.d(a,{J:()=>r,N:()=>i});var n=s(9379);const l=[{id:1,fullName:"Ng\u01b0\u1eddi D\xf9ng Demo",email:"user@example.com",role:"USER",status:"ACTIVE",avatar:"https://i.pravatar.cc/150?u=user@example.com",phoneNumber:"0123456789",address:"123 \u0110\u01b0\u1eddng ABC, Qu\u1eadn 1, TP. HCM"},{id:2,fullName:"Qu\u1ea3n Tr\u1ecb Vi\xean",email:"admin@example.com",role:"ADMIN",status:"ACTIVE",avatar:"https://i.pravatar.cc/150?u=admin@example.com",phoneNumber:"0987654321",address:"456 \u0110\u01b0\u1eddng XYZ, Qu\u1eadn 3, TP. HCM"},{id:3,fullName:"T\xe0i Kho\u1ea3n B\u1ecb Kh\xf3a",email:"banned@example.com",role:"USER",status:"BANNED",avatar:"https://i.pravatar.cc/150?u=banned@example.com",phoneNumber:"0111222333",address:"789 \u0110\u01b0\u1eddng DEF, Qu\u1eadn 5, TP. HCM"}],t=e=>new Promise(a=>setTimeout(a,e)),r=async()=>(await t(500),console.log("MOCK: getAllUserApi"),[...l]),i=async(e,a)=>{await t(400),console.log("MOCK: updateUserApi",{userId:e,payload:a});const s=l.findIndex(a=>a.id.toString()===e.toString());if(s>-1)return l[s]=(0,n.A)((0,n.A)({},l[s]),a),l[s];throw new Error("User not found")}},8444:(e,a,s)=>{s.r(a),s.d(a,{default:()=>W});var n=s(9379),l=s(5043),t=s(6446),r=s(5865),i=s(9650),o=s(1806),c=s(4882),d=s(8076),u=s(2420),m=s(3460),h=s(1045),x=s(3845),A=s(3336),g=s(1637),j=s(4194),f=s(35),p=s(6600),v=s(2935),C=s(8903),N=s(5795),b=s(3193),M=s(8356),y=s(9285),P=s(2143),S=s(9347),E=s(1906),I=s(7488),k=s(2078),w=s(6106),D=s(4117),T=s(579);const R=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split(" ").map(e=>e[0]).join("").toUpperCase()},U=e=>{let{users:a,title:s,onRowClick:n,t:l}=e;return(0,T.jsxs)(t.A,{sx:{mb:4},children:[(0,T.jsx)(r.A,{variant:"h5",gutterBottom:!0,component:"h2",children:s}),(0,T.jsx)(i.A,{children:(0,T.jsxs)(o.A,{stickyHeader:!0,children:[(0,T.jsx)(c.A,{children:(0,T.jsxs)(d.A,{children:[(0,T.jsx)(u.A,{sx:{width:"10%"},children:l("profile.avatar")}),(0,T.jsx)(u.A,{children:l("register.fullName")}),(0,T.jsx)(u.A,{children:l("register.email")}),(0,T.jsx)(u.A,{align:"center",children:l("profile.settings")}),(0,T.jsx)(u.A,{children:l("profile.role")}),(0,T.jsx)(u.A,{children:l("productPage.published")}),(0,T.jsx)(u.A,{children:l("admin.dashboardPage.recentLogins")})]})}),(0,T.jsx)(m.A,{children:a.map(e=>(0,T.jsxs)(d.A,{hover:!0,onClick:()=>n(e),sx:{cursor:"pointer"},children:[(0,T.jsx)(u.A,{children:(0,T.jsx)(h.A,{src:e.avatarUrl,children:R(e.fullName)})}),(0,T.jsx)(u.A,{children:e.fullName}),(0,T.jsx)(u.A,{children:e.email}),(0,T.jsx)(u.A,{align:"center",children:(0,T.jsx)(x.A,{label:e.status,color:"ACTIVE"===e.status?"success":"default",size:"small"})}),(0,T.jsx)(u.A,{children:(0,T.jsx)(x.A,{label:e.role,color:"ADMIN"===e.role?"secondary":"default",size:"small"})}),(0,T.jsx)(u.A,{children:new Date(e.createdAt).toLocaleDateString()}),(0,T.jsx)(u.A,{children:e.lastLogin?new Date(e.lastLogin).toLocaleString():"N/A"})]},e.id))})]})}),0===a.length&&(0,T.jsx)(r.A,{sx:{mt:2,textAlign:"center"},children:l("admin.userManagementPage.noUsersInCategory")})]})},W=()=>{const[e,a]=(0,l.useState)([]),[s,i]=(0,l.useState)(!0),[o,c]=(0,l.useState)(null),[d,u]=(0,l.useState)(!1),[m,h]=(0,l.useState)(null),[x,R]=(0,l.useState)(!1),[W,L]=(0,l.useState)(""),[B,V]=(0,l.useState)(""),[F,H]=(0,l.useState)(!1),{t:K}=(0,D.Bd)(),Q=(0,l.useCallback)(async()=>{try{i(!0),c(null);const e=await(0,k.J)();a(e||[])}catch(e){c(K("admin.userManagementPage.fetchError")),a([]),console.error(e)}finally{i(!1)}},[K]);(0,l.useEffect)(()=>{Q()},[Q]);const{staff:z,customers:J}=(0,l.useMemo)(()=>({staff:e.filter(e=>"ADMIN"===e.role),customers:e.filter(e=>"USER"===e.role)}),[e]),O=e=>{h(e),u(!0)},G=()=>{u(!1),h(null),R(!1),L(""),V("")},X=e=>{const{name:a,value:s}=e.target;h(e=>(0,n.A)((0,n.A)({},e),{},{[a]:s}))};return(0,T.jsxs)(A.A,{sx:{p:3,m:2},children:[(0,T.jsx)(r.A,{variant:"h4",gutterBottom:!0,children:K("admin.userManagementPage.title")}),s?(0,T.jsx)(t.A,{sx:{display:"flex",justifyContent:"center",my:5},children:(0,T.jsx)(g.A,{})}):o?(0,T.jsx)(j.A,{severity:"error",children:o}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(U,{users:z,title:K("admin.userManagementPage.staff"),onRowClick:O,t:K}),(0,T.jsx)(U,{users:J,title:K("admin.userManagementPage.customers"),onRowClick:O,t:K})]}),(0,T.jsxs)(f.A,{open:d,onClose:G,maxWidth:"sm",fullWidth:!0,disableScrollLock:!0,children:[(0,T.jsx)(p.A,{children:K("admin.userManagementPage.editUser")}),m&&(0,T.jsx)(v.A,{children:(0,T.jsxs)(C.Ay,{container:!0,spacing:2,sx:{mt:1},children:[(0,T.jsx)(C.Ay,{item:!0,xs:12,children:(0,T.jsx)(N.A,{fullWidth:!0,label:K("register.fullName"),name:"fullName",value:m.fullName,disabled:!0})}),(0,T.jsx)(C.Ay,{item:!0,xs:12,children:(0,T.jsx)(N.A,{fullWidth:!0,label:K("register.email"),name:"email",value:m.email,disabled:!0})}),(0,T.jsx)(C.Ay,{item:!0,xs:12,children:(0,T.jsxs)(b.A,{fullWidth:!0,children:[(0,T.jsx)(M.A,{children:K("profile.settings")}),(0,T.jsxs)(y.A,{name:"status",value:m.status,label:K("profile.settings"),onChange:X,MenuProps:{disableScrollLock:!0},children:[(0,T.jsx)(P.A,{value:"ACTIVE",children:"ACTIVE"}),(0,T.jsx)(P.A,{value:"INACTIVE",children:"INACTIVE"}),(0,T.jsx)(P.A,{value:"BANNED",children:"BANNED"})]})]})}),(0,T.jsx)(C.Ay,{item:!0,xs:12,children:(0,T.jsxs)(b.A,{fullWidth:!0,children:[(0,T.jsx)(M.A,{children:K("profile.role")}),(0,T.jsxs)(y.A,{name:"role",value:m.role,label:K("profile.role"),onChange:X,MenuProps:{disableScrollLock:!0},children:[(0,T.jsx)(P.A,{value:"USER",children:"USER"}),(0,T.jsx)(P.A,{value:"ADMIN",children:"ADMIN"})]})]})})]})}),(0,T.jsxs)(S.A,{children:[(0,T.jsx)(E.A,{onClick:G,children:K("action.cancel")}),(0,T.jsx)(E.A,{onClick:()=>{u(!1),R(!0)},color:"primary",children:K("admin.userManagementPage.sendEmail")}),(0,T.jsx)(E.A,{onClick:async()=>{if(m)try{const{id:e,role:a,status:s}=m;await(0,k.N)(e,{role:a,status:s}),I.oR.success(K("admin.userManagementPage.updateSuccess")),G(),Q()}catch(e){console.error("Failed to update user:",e),I.oR.error(K("admin.userManagementPage.updateError"))}},variant:"contained",children:K("action.saveChanges")})]})]}),(0,T.jsxs)(f.A,{open:x,onClose:G,maxWidth:"md",fullWidth:!0,children:[(0,T.jsxs)(p.A,{children:[K("admin.userManagementPage.sendEmailTo")," ",null===m||void 0===m?void 0:m.fullName]}),(0,T.jsxs)(v.A,{children:[(0,T.jsxs)(r.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:[K("register.email"),": ",null===m||void 0===m?void 0:m.email]}),(0,T.jsx)(N.A,{autoFocus:!0,margin:"dense",id:"subject",label:K("admin.userManagementPage.emailSubject"),type:"text",fullWidth:!0,variant:"outlined",value:W,onChange:e=>L(e.target.value)}),(0,T.jsx)(N.A,{margin:"dense",id:"body",label:K("admin.userManagementPage.emailContent"),type:"text",fullWidth:!0,multiline:!0,rows:8,variant:"outlined",value:B,onChange:e=>V(e.target.value)})]}),(0,T.jsxs)(S.A,{children:[(0,T.jsx)(E.A,{onClick:G,children:K("action.cancel")}),(0,T.jsx)(E.A,{onClick:async()=>{if(m&&W&&B){H(!0);try{const e={userId:m.id,subject:W,message:B,type:"EMAIL",status:"PENDING"};await(0,w.D)(e),I.oR.success("".concat(K("admin.userManagementPage.emailSentSuccess")," ").concat(m.fullName)),G()}catch(e){console.error("Failed to send email:",e),I.oR.error(K("admin.userManagementPage.emailSentError"))}finally{H(!1)}}else I.oR.warn(K("admin.userManagementPage.emailFormInvalid"))},variant:"contained",disabled:F,children:K(F?"admin.userManagementPage.sending":"admin.userManagementPage.send")})]})]})]})}}}]);
//# sourceMappingURL=444.e8a32401.chunk.js.map