{"version":3,"file":"static/js/864.fa8df255.chunk.js","mappings":"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","sources":["api/orderApi.js","pages/CheckoutPage.jsx","components/BreadcrumbsComponent.jsx"],"sourcesContent":["// MOCK IMPLEMENTATION\r\nimport { fetchProduct, reduceStockApi } from \"./productApi\"; // Sử dụng các phiên bản đã mock\r\n\r\nlet mockOrders = [\r\n    {\r\n        id: 101,\r\n        userId: 1,\r\n        orderDate: new Date('2023-10-26T10:00:00Z').toISOString(),\r\n        status: \"DELIVERED\",\r\n        totalAmount: 229000,\r\n        shippingAddress: { fullName: 'Người Dùng Demo', address: '123 Đường ABC, Quận 1, TP. HCM', phoneNumber: '0123456789' },\r\n        orderItems: [\r\n            { productId: 1, name: \"Lược Sử Loài Người\", quantity: 1, price: 150000 },\r\n            { productId: 2, name: \"Nhà Giả Kim\", quantity: 1, price: 79000 },\r\n        ]\r\n    },\r\n    {\r\n        id: 102,\r\n        userId: 1,\r\n        orderDate: new Date('2023-10-28T14:30:00Z').toISOString(),\r\n        status: \"PENDING\",\r\n        totalAmount: 165000,\r\n        shippingAddress: { fullName: 'Người Dùng Demo', address: '123 Đường ABC, Quận 1, TP. HCM', phoneNumber: '0123456789' },\r\n        orderItems: [\r\n            { productId: 4, name: \"Sapiens: Lược Sử Tương Lai\", quantity: 1, price: 165000 },\r\n        ]\r\n    }\r\n];\r\nlet nextOrderId = 103;\r\n\r\nconst delay = (ms) => new Promise(resolve => setTimeout(resolve, ms));\r\n\r\nexport const createOrderApi = async (payload) => {\r\n    await delay(1000);\r\n    console.log(\"MOCK: createOrderApi\", payload);\r\n\r\n    // Mô phỏng logic từ file gốc\r\n    try {\r\n        for (const item of payload.orderItems) {\r\n            const product = await fetchProduct(item.productId);\r\n            await reduceStockApi(item.productId, product.stockQuantity - item.quantity);\r\n        }\r\n    } catch (error) {\r\n        console.error(\"MOCK: Lỗi trừ kho khi tạo đơn hàng\", error);\r\n        throw new Error(\"Không thể cập nhật kho, đơn hàng chưa được tạo.\");\r\n    }\r\n\r\n    const newOrder = {\r\n        id: nextOrderId++,\r\n        userId: payload.userId,\r\n        orderDate: new Date().toISOString(),\r\n        status: \"PENDING\",\r\n        totalAmount: payload.totalAmount,\r\n        orderItems: payload.orderItems,\r\n        shippingAddress: payload.shippingAddress,\r\n    };\r\n    mockOrders.push(newOrder);\r\n\r\n    // File gốc trả về toàn bộ object response, ta mô phỏng điều đó\r\n    return { data: newOrder };\r\n};\r\n\r\nexport const getMyOrdersApi = async (userId, params = {}) => {\r\n    await delay(500);\r\n    console.log(`MOCK: getMyOrdersApi for user ${userId}`, { params });\r\n    return mockOrders.filter(o => o.userId.toString() === userId.toString());\r\n};\r\n\r\nexport const getAllOrdersApi = async () => {\r\n    await delay(500);\r\n    console.log(\"MOCK: getAllOrdersApi\");\r\n    return [...mockOrders];\r\n};\r\n\r\nexport const updateOrderStatusApi = async (orderId, status) => {\r\n    await delay(300);\r\n    console.log(`MOCK: updateOrderStatusApi for order ${orderId} to status ${status}`);\r\n    const order = mockOrders.find(o => o.id.toString() === orderId.toString());\r\n    if (order) {\r\n        order.status = status;\r\n        return order;\r\n    }\r\n    throw new Error(\"Order not found\");\r\n};","import React, { useContext, useState, useEffect } from 'react';\r\nimport { Container, Grid, Paper, Typography, TextField, Button, Box, Divider, List, ListItem, ListItemText, RadioGroup, FormControlLabel, Radio, FormControl, FormLabel, CircularProgress } from '@mui/material';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { CartContext } from '../context/CartContext';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { toast } from 'react-toastify';\r\nimport BreadcrumbsComponent from '../components/BreadcrumbsComponent';\r\nimport { createOrderApi } from '../api/orderApi';\r\n\r\nconst CheckoutPage = () => {\r\n  const { t, i18n } = useTranslation();\r\n  const navigate = useNavigate();\r\n  const { items, total, clearCart } = useContext(CartContext);\r\n  const { user, isAuthenticated, loading: authLoading } = useContext(AuthContext);\r\n\r\n  const [shippingInfo, setShippingInfo] = useState({\r\n    fullName: user?.fullName || '',\r\n    address: user?.address || '',\r\n    phoneNumber: user?.phoneNumber || '',\r\n    email: user?.email || '',\r\n  });\r\n  const [paymentMethod, setPaymentMethod] = useState('cod'); // 'cod' or 'paypal'\r\n  const [isPlacingOrder, setIsPlacingOrder] = useState(false);\r\n\r\n  const formatPrice = (price) => {\r\n    if (price === null || price === undefined) return '';\r\n    const currentLang = i18n.language.split('-')[0];\r\n    if (currentLang === 'vi') {\r\n      // Tạm thời giả định tỉ giá 1 USD = 25,000 VND.\r\n      const vndPrice = price * 25000;\r\n      return `${vndPrice.toLocaleString('vi-VN')} ₫`;\r\n    }\r\n    return `$${price.toFixed(2)}`;\r\n  };\r\n\r\n  useEffect(() => {\r\n    // Khi context auth hết loading và xác định người dùng chưa đăng nhập\r\n    if (!authLoading && !isAuthenticated) {\r\n      // toast.info(t('cart.loginPrompt'));\r\n      toast.info(t('cart.summary.loginPrompt'));\r\n      // Chuyển hướng về trang đăng nhập và lưu lại trang checkout để quay lại\r\n      navigate('/login', { state: { from: '/checkout' }, replace: true });\r\n    }\r\n  }, [isAuthenticated, authLoading, navigate, t]);\r\n\r\n  const handleInputChange = (e) => {\r\n    setShippingInfo({ ...shippingInfo, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const handlePlaceOrder = async (e) => {\r\n    e.preventDefault();\r\n    setIsPlacingOrder(true);\r\n    try {\r\n      const orderPayload = {\r\n        userId: user.id,\r\n        userName: user.fullName,\r\n        orderItems: items.map(item => ({\r\n          productId: item.id,\r\n          quantity: item.qty\r\n        })),\r\n        totalAmount: total,\r\n        status: \"PENDING\"\r\n      };\r\n\r\n      // Gọi API để tạo đơn hàng\r\n      await createOrderApi(orderPayload);\r\n\r\n      toast.success(t('checkout.orderPlacedSuccess'));\r\n      clearCart();\r\n      navigate('/cart'); // Chuyển về trang giỏ hàng sau khi đặt hàng\r\n    } catch (error) {\r\n      console.error(\"Failed to place order:\", error);\r\n      toast.error(error.response?.data?.message || \"Failed to place order. Please try again.\");\r\n    } finally {\r\n      setIsPlacingOrder(false);\r\n    }\r\n  };\r\n\r\n  if (authLoading || !isAuthenticated) {\r\n    return <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '60vh' }}><CircularProgress /></Box>;\r\n  }\r\n\r\n  if (items.length === 0) {\r\n    return (\r\n      <Container sx={{ textAlign: 'center', mt: 8 }}>\r\n        <Typography variant=\"h5\">{t('checkout.noItems')}</Typography>\r\n        <Button variant=\"contained\" sx={{ mt: 2 }} onClick={() => navigate('/')}>\r\n          {t('cart.continueShopping')}\r\n        </Button>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Container maxWidth=\"lg\" sx={{ mt: 4, mb: 4 }}>\r\n      <BreadcrumbsComponent links={[{ label: t('breadcrumbs.checkout') }]} sx={{ mb: 3 }} />\r\n      <Typography variant=\"h4\" component=\"h1\" gutterBottom fontWeight=\"bold\">\r\n        {t('checkout.title')}\r\n      </Typography>\r\n      <form onSubmit={handlePlaceOrder}>\r\n        <Grid container spacing={4}>\r\n          {/* Shipping Information */}\r\n          <Grid item xs={12} md={7}>\r\n            <Paper variant=\"outlined\" sx={{ p: 3, borderRadius: 2 }}>\r\n              <Typography variant=\"h6\" gutterBottom>{t('checkout.shippingInfo')}</Typography>\r\n              <Grid container spacing={2}>\r\n                <Grid item xs={12}><TextField required fullWidth name=\"fullName\" label={t('register.fullName')} value={shippingInfo.fullName} onChange={handleInputChange} /></Grid>\r\n                <Grid item xs={12}><TextField required fullWidth name=\"address\" label={t('register.address')} value={shippingInfo.address} onChange={handleInputChange} /></Grid>\r\n                <Grid item xs={12} sm={6}><TextField required fullWidth name=\"phoneNumber\" label={t('register.phoneNumber')} value={shippingInfo.phoneNumber} onChange={handleInputChange} /></Grid>\r\n                <Grid item xs={12} sm={6}><TextField required fullWidth name=\"email\" type=\"email\" label={t('register.email')} value={shippingInfo.email} onChange={handleInputChange} /></Grid>\r\n              </Grid>\r\n            </Paper>\r\n\r\n            {/* Payment Method */}\r\n            <Paper variant=\"outlined\" sx={{ p: 3, mt: 4, borderRadius: 2 }}>\r\n              <FormControl component=\"fieldset\">\r\n                <FormLabel component=\"legend\" sx={{ mb: 1, fontWeight: 'bold', color: 'text.primary' }}>{t('checkout.paymentMethod')}</FormLabel>\r\n                <RadioGroup row name=\"paymentMethod\" value={paymentMethod} onChange={(e) => setPaymentMethod(e.target.value)}>\r\n                  <FormControlLabel value=\"cod\" control={<Radio />} label={t('checkout.cod')} />\r\n                  <FormControlLabel value=\"paypal\" control={<Radio />} label={t('checkout.paypal')} disabled />\r\n                </RadioGroup>\r\n              </FormControl>\r\n            </Paper>\r\n          </Grid>\r\n\r\n          {/* Order Summary */}\r\n          <Grid item xs={12} md={5}>\r\n            <Paper variant=\"outlined\" sx={{ p: 3, position: 'sticky', top: 88, borderRadius: 2 }}>\r\n              <Typography variant=\"h6\" gutterBottom>{t('cart.summary.title')}</Typography>\r\n              <Divider />\r\n              <List>\r\n                {items.map(item => (\r\n                  <ListItem key={item.id} disableGutters>\r\n                    <ListItemText \r\n                      primary={`${item.name} (x${item.qty})`} \r\n                      // FIX: `item.authors` is an array of objects. Map to names. Also fixes typo `item.author`.\r\n                      secondary={(Array.isArray(item.authors) && item.authors.length > 0)\r\n                        ? item.authors.map(author => author.name).join(', ') : ''} \r\n                    />\r\n                    <Typography variant=\"body2\">{formatPrice(item.price * item.qty)}</Typography>\r\n                  </ListItem>\r\n                ))}\r\n              </List>\r\n              <Divider />\r\n              <Box sx={{ display: 'flex', justifyContent: 'space-between', my: 2 }}>\r\n                <Typography>{t('cart.summary.subtotal', { count: items.length })}</Typography>\r\n                <Typography fontWeight=\"bold\">{formatPrice(total)}</Typography>\r\n              </Box>\r\n              <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 2 }}>\r\n                <Typography>{t('cart.summary.shipping')}</Typography>\r\n                <Typography fontWeight=\"bold\">{t('cart.summary.free')}</Typography>\r\n              </Box>\r\n              <Divider />\r\n              <Box sx={{ display: 'flex', justifyContent: 'space-between', mt: 2, mb: 3 }}>\r\n                <Typography variant=\"h5\" fontWeight=\"bold\">{t('cart.summary.total')}</Typography>\r\n                <Typography variant=\"h5\" fontWeight=\"bold\">{formatPrice(total)}</Typography>\r\n              </Box>\r\n              <Button type=\"submit\" fullWidth variant=\"contained\" size=\"large\" disabled={isPlacingOrder}>\r\n                {isPlacingOrder ? (\r\n                  <CircularProgress size={26} color=\"inherit\" />\r\n                ) : (\r\n                  t('checkout.placeOrder')\r\n                )}\r\n              </Button>\r\n            </Paper>\r\n          </Grid>\r\n        </Grid>\r\n      </form>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default CheckoutPage;\r\n","import React from 'react';\r\nimport { Breadcrumbs as MuiBreadcrumbs, Link, Typography, Container } from '@mui/material';\r\nimport { Link as RouterLink } from 'react-router-dom';\r\nimport { useTranslation } from 'react-i18next';\r\nimport HomeIcon from '@mui/icons-material/Home';\r\n\r\n/**\r\n * A reusable breadcrumbs component.\r\n * @param {Object} props\r\n * @param {Array<Object>} props.links - An array of link objects. Each object should have `to` (optional) and `label`.\r\n * e.g. [{ to: '/products', label: 'Products' }, { label: 'Product Name' }]\r\n */\r\nconst BreadcrumbsComponent = ({ links = [] }) => {\r\n  const { t } = useTranslation();\r\n\r\n  const allLinks = [\r\n    { to: '/', label: t('breadcrumbs.home'), icon: <HomeIcon sx={{ mr: 2, fontSize: 'inherit' }} /> },\r\n    ...links,\r\n  ];\r\n\r\n  return (\r\n    <Container maxWidth=\"lg\" sx={{ pt: 0, pb: { xs: 1, md: 2 } }}>\r\n      <MuiBreadcrumbs aria-label=\"breadcrumb\">\r\n        {allLinks.map((link, index) => {\r\n          const isLast = index === allLinks.length - 1;\r\n          if (isLast) {\r\n            return (\r\n              <Typography\r\n                key={index}\r\n                color=\"text.primary\"\r\n                sx={{ display: 'flex', alignItems: 'center' }}\r\n              >\r\n                {link.icon}\r\n                {link.label}\r\n              </Typography>\r\n            );\r\n          }\r\n          return (\r\n            <Link\r\n              component={RouterLink}\r\n              to={link.to}\r\n              key={index}\r\n              underline=\"hover\"\r\n              color=\"inherit\"\r\n              sx={{ display: 'flex', alignItems: 'center' }}\r\n            >\r\n              {link.icon}\r\n              {link.label}\r\n            </Link>\r\n          );\r\n        })}\r\n      </MuiBreadcrumbs>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default BreadcrumbsComponent;\r\n"],"names":["mockOrders","id","userId","orderDate","Date","toISOString","status","totalAmount","shippingAddress","fullName","address","phoneNumber","orderItems","productId","name","quantity","price","nextOrderId","delay","ms","Promise","resolve","setTimeout","createOrderApi","async","console","log","payload","item","product","fetchProduct","reduceStockApi","stockQuantity","error","Error","newOrder","push","data","getMyOrdersApi","params","arguments","length","undefined","concat","filter","o","toString","getAllOrdersApi","updateOrderStatusApi","orderId","order","find","CheckoutPage","t","i18n","useTranslation","navigate","useNavigate","items","total","clearCart","useContext","CartContext","user","isAuthenticated","loading","authLoading","AuthContext","shippingInfo","setShippingInfo","useState","email","paymentMethod","setPaymentMethod","isPlacingOrder","setIsPlacingOrder","formatPrice","language","split","toLocaleString","toFixed","useEffect","toast","info","state","from","replace","handleInputChange","e","_objectSpread","target","value","_jsx","Box","sx","display","justifyContent","alignItems","height","children","CircularProgress","_jsxs","Container","textAlign","mt","Typography","variant","Button","onClick","maxWidth","mb","BreadcrumbsComponent","links","label","component","gutterBottom","fontWeight","onSubmit","preventDefault","orderPayload","userName","map","qty","success","_error$response","_error$response$data","response","message","Grid","container","spacing","xs","md","Paper","p","borderRadius","TextField","required","fullWidth","onChange","sm","type","FormControl","FormLabel","color","RadioGroup","row","FormControlLabel","control","Radio","disabled","position","top","Divider","List","ListItem","disableGutters","ListItemText","primary","secondary","Array","isArray","authors","author","join","my","count","size","_ref","allLinks","to","icon","HomeIcon","mr","fontSize","pt","pb","MuiBreadcrumbs","link","index","Link","RouterLink","underline"],"ignoreList":[],"sourceRoot":""}