{"version":3,"file":"static/js/444.cbd088e0.chunk.js","mappings":"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","sources":["api/userApi.js","pages/admin/UserManagementPage.jsx"],"sourcesContent":["import client from \"./client\"; // Sử dụng client axios tập trung\r\n\r\nexport const getAllUserApi = async () => {\r\n  // Interceptor sẽ tự động đính kèm token\r\n  const res = await client.get(`/users`);\r\n  return res.data;\r\n};\r\n\r\nexport const updateUserApi = async (userId, payload) => {\r\n  // Interceptor sẽ tự động đính kèm token\r\n  const res = await client.patch(`/users/${userId}`, payload);\r\n  return res.data;\r\n};","import React, { useEffect, useState, useMemo, useCallback } from 'react';\r\nimport {\r\n  Box,\r\n  Typography,\r\n  Paper,\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableContainer,\r\n  TableHead,\r\n  TableRow,\r\n  CircularProgress,\r\n  Alert,\r\n  Avatar,\r\n  Chip,\r\n  Dialog,\r\n  DialogActions,\r\n  DialogContent,\r\n  DialogTitle,\r\n  TextField,\r\n  Button,\r\n  FormControl,\r\n  InputLabel,\r\n  Select,\r\n  MenuItem,\r\n  Grid,\r\n} from '@mui/material';\r\nimport { toast } from 'react-toastify';\r\nimport { getAllUserApi, updateUserApi } from '../../api/userApi';\r\nimport { sendEmailApi } from '../../api/notificationApi';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\n\r\n// Helper to get initials from name for Avatar\r\nconst getInitials = (name = '') => {\r\n  const initials = name\r\n    .split(' ')\r\n    .map((n) => n[0])\r\n    .join('');\r\n  return initials.toUpperCase();\r\n};\r\n\r\n// Reusable User Table Component\r\nconst UserTable = ({ users, title, onRowClick, t }) => (\r\n  <Box sx={{ mb: 4 }}>\r\n    <Typography variant=\"h5\" gutterBottom component=\"h2\">{title}</Typography>\r\n    <TableContainer>\r\n      <Table stickyHeader>\r\n        <TableHead>\r\n          <TableRow>\r\n            <TableCell sx={{ width: '10%' }}>{t('profile.avatar')}</TableCell>\r\n            <TableCell>{t('register.fullName')}</TableCell>\r\n            <TableCell>{t('register.email')}</TableCell>\r\n            <TableCell align=\"center\">{t('profile.settings')}</TableCell>\r\n            <TableCell>{t('profile.role')}</TableCell>\r\n            <TableCell>{t('productPage.published')}</TableCell>\r\n            <TableCell>{t('admin.dashboardPage.recentLogins')}</TableCell>\r\n          </TableRow>\r\n        </TableHead>\r\n        <TableBody>\r\n          {users.map((user) => (\r\n            <TableRow hover key={user.id} onClick={() => onRowClick(user)} sx={{ cursor: 'pointer' }}>\r\n              <TableCell><Avatar src={user.avatarUrl}>{getInitials(user.fullName)}</Avatar></TableCell>\r\n              <TableCell>{user.fullName}</TableCell>\r\n              <TableCell>{user.email}</TableCell>\r\n              <TableCell align=\"center\"><Chip label={user.status} color={user.status === 'ACTIVE' ? 'success' : 'default'} size=\"small\" /></TableCell>\r\n              <TableCell>\r\n                <Chip label={user.role} color={user.role === 'ADMIN' ? 'secondary' : 'default'} size=\"small\" />\r\n              </TableCell>\r\n              <TableCell>{new Date(user.createdAt).toLocaleDateString()}</TableCell>\r\n              <TableCell>{user.lastLogin ? new Date(user.lastLogin).toLocaleString() : 'N/A'}</TableCell>\r\n            </TableRow>\r\n          ))}\r\n        </TableBody>\r\n      </Table>\r\n    </TableContainer>\r\n    {users.length === 0 && <Typography sx={{ mt: 2, textAlign: 'center' }}>{t('admin.userManagementPage.noUsersInCategory')}</Typography>}\r\n  </Box>\r\n);\r\n\r\nconst UserManagementPage = () => {\r\n  const [users, setUsers] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [editingUser, setEditingUser] = useState(null);\r\n  const [isEmailModalOpen, setIsEmailModalOpen] = useState(false);\r\n  const [emailSubject, setEmailSubject] = useState('');\r\n  const [emailBody, setEmailBody] = useState('');\r\n  const [isSending, setIsSending] = useState(false);\r\n\r\n  const { t } = useTranslation();\r\n\r\n  const fetchUsers = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      const data = await getAllUserApi();\r\n      setUsers(data || []);\r\n    } catch (err) {\r\n      setError(t('admin.userManagementPage.fetchError'));\r\n      setUsers([]);\r\n      console.error(err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [t]);\r\n\r\n  useEffect(() => {\r\n    fetchUsers();\r\n  }, [fetchUsers]);\r\n\r\n  const { staff, customers } = useMemo(() => {\r\n    const staffList = users.filter(user => user.role === 'ADMIN');\r\n    const customerList = users.filter(user => user.role === 'USER');\r\n    return { staff: staffList, customers: customerList };\r\n  }, [users]);\r\n\r\n  const handleRowClick = (user) => {\r\n    setEditingUser(user);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleCloseModal = () => {\r\n    setIsModalOpen(false);\r\n    setEditingUser(null);\r\n    setIsEmailModalOpen(false);\r\n    setEmailSubject(''); setEmailBody('');\r\n  };\r\n\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setEditingUser(prev => ({ ...prev, [name]: value }));\r\n  };\r\n\r\n  const handleSaveUser = async () => {\r\n    if (!editingUser) return;\r\n    try {\r\n      // Chỉ gửi những trường cần thiết để cập nhật\r\n      const { id, role, status } = editingUser;\r\n      await updateUserApi(id, { role, status });\r\n      toast.success(t('admin.userManagementPage.updateSuccess'));\r\n      handleCloseModal();\r\n      fetchUsers(); // Tải lại danh sách người dùng\r\n    } catch (apiError) {\r\n      console.error('Failed to update user:', apiError);\r\n      toast.error(t('admin.userManagementPage.updateError'));\r\n    }\r\n  };\r\n\r\n  const handleOpenEmailModal = () => {\r\n    setIsModalOpen(false); // Đóng modal edit\r\n    setIsEmailModalOpen(true); // Mở modal gửi email\r\n  };\r\n\r\n  const handleSendEmail = async () => {\r\n    if (!editingUser || !emailSubject || !emailBody) {\r\n      toast.warn(t('admin.userManagementPage.emailFormInvalid'));\r\n      return;\r\n    }\r\n    setIsSending(true);\r\n    try {\r\n      const payload = {\r\n        userId: editingUser.id,\r\n        subject: emailSubject,\r\n        message: emailBody,\r\n        type: 'EMAIL', // Thêm loại thông báo là EMAIL\r\n        status: 'PENDING' // Thêm trạng thái ban đầu\r\n      };\r\n      await sendEmailApi(payload);\r\n      toast.success(`${t('admin.userManagementPage.emailSentSuccess')} ${editingUser.fullName}`);\r\n      handleCloseModal(); // Đóng tất cả modal và reset state\r\n    } catch (apiError) {\r\n      console.error('Failed to send email:', apiError);\r\n      toast.error(t('admin.userManagementPage.emailSentError'));\r\n    } finally {\r\n      setIsSending(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Paper sx={{ p: 3, m: 2 }}>\r\n      <Typography variant=\"h4\" gutterBottom>{t('admin.userManagementPage.title')}</Typography>\r\n\r\n      {loading ? (\r\n        <Box sx={{ display: 'flex', justifyContent: 'center', my: 5 }}><CircularProgress /></Box>\r\n      ) : error ? (\r\n        <Alert severity=\"error\">{error}</Alert>\r\n      ) : (\r\n        <>\r\n          <UserTable users={staff} title={t('admin.userManagementPage.staff')} onRowClick={handleRowClick} t={t} />\r\n          <UserTable users={customers} title={t('admin.userManagementPage.customers')} onRowClick={handleRowClick} t={t} />\r\n        </>\r\n      )}\r\n\r\n      {/* Edit User Modal */}\r\n      <Dialog open={isModalOpen} onClose={handleCloseModal} maxWidth=\"sm\" fullWidth disableScrollLock={true}>\r\n        <DialogTitle>{t('admin.userManagementPage.editUser')}</DialogTitle>\r\n        {editingUser && (\r\n          <DialogContent>\r\n            <Grid container spacing={2} sx={{ mt: 1 }}>\r\n              <Grid item xs={12}>\r\n                <TextField fullWidth label={t('register.fullName')} name=\"fullName\" value={editingUser.fullName} disabled />\r\n              </Grid>\r\n              <Grid item xs={12}>\r\n                <TextField fullWidth label={t('register.email')} name=\"email\" value={editingUser.email} disabled />\r\n              </Grid>\r\n              <Grid item xs={12}>\r\n                <FormControl fullWidth>\r\n                  <InputLabel>{t('profile.settings')}</InputLabel>\r\n                  <Select name=\"status\" value={editingUser.status} label={t('profile.settings')} onChange={handleInputChange} MenuProps={{ disableScrollLock: true }}>\r\n                    <MenuItem value=\"ACTIVE\">ACTIVE</MenuItem>\r\n                    <MenuItem value=\"INACTIVE\">INACTIVE</MenuItem>\r\n                    <MenuItem value=\"BANNED\">BANNED</MenuItem>\r\n                  </Select>\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item xs={12}>\r\n                <FormControl fullWidth>\r\n                  <InputLabel>{t('profile.role')}</InputLabel>\r\n                  <Select name=\"role\" value={editingUser.role} label={t('profile.role')} onChange={handleInputChange} MenuProps={{ disableScrollLock: true }}>\r\n                    <MenuItem value=\"USER\">USER</MenuItem>\r\n                    <MenuItem value=\"ADMIN\">ADMIN</MenuItem>\r\n                  </Select>\r\n                </FormControl>\r\n              </Grid>\r\n            </Grid>\r\n          </DialogContent>\r\n        )}\r\n        <DialogActions>\r\n          <Button onClick={handleCloseModal}>{t('action.cancel')}</Button>\r\n          <Button onClick={handleOpenEmailModal} color=\"primary\">{t('admin.userManagementPage.sendEmail')}</Button>\r\n          <Button onClick={handleSaveUser} variant=\"contained\">{t('profile.saveChanges')}</Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      {/* Send Email Modal */}\r\n      <Dialog open={isEmailModalOpen} onClose={handleCloseModal} maxWidth=\"md\" fullWidth>\r\n        <DialogTitle>{t('admin.userManagementPage.sendEmailTo')} {editingUser?.fullName}</DialogTitle>\r\n        <DialogContent>\r\n            <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 2 }}>\r\n              {t('register.email')}: {editingUser?.email}\r\n            </Typography>\r\n            <TextField\r\n              autoFocus\r\n              margin=\"dense\"\r\n              id=\"subject\"\r\n              label={t('admin.userManagementPage.emailSubject')}\r\n              type=\"text\"\r\n              fullWidth\r\n              variant=\"outlined\"\r\n              value={emailSubject}\r\n              onChange={(e) => setEmailSubject(e.target.value)}\r\n            />\r\n            <TextField\r\n              margin=\"dense\" id=\"body\" label={t('admin.userManagementPage.emailContent')} type=\"text\" fullWidth multiline rows={8} variant=\"outlined\" value={emailBody} onChange={(e) => setEmailBody(e.target.value)}\r\n            />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleCloseModal}>{t('action.cancel')}</Button>\r\n          <Button onClick={handleSendEmail} variant=\"contained\" disabled={isSending}>{isSending ? t('admin.userManagementPage.sending') : t('admin.userManagementPage.send')}</Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Paper>\r\n  );\r\n};\r\n\r\nexport default UserManagementPage;"],"names":["getAllUserApi","async","client","get","data","updateUserApi","userId","payload","patch","concat","getInitials","arguments","length","undefined","split","map","n","join","toUpperCase","UserTable","_ref","users","title","onRowClick","t","_jsxs","Box","sx","mb","children","_jsx","Typography","variant","gutterBottom","component","TableContainer","Table","stickyHeader","TableHead","TableRow","TableCell","width","align","TableBody","user","hover","onClick","cursor","Avatar","src","avatarUrl","fullName","email","Chip","label","status","color","size","role","Date","createdAt","toLocaleDateString","lastLogin","toLocaleString","id","mt","textAlign","UserManagementPage","setUsers","useState","loading","setLoading","error","setError","isModalOpen","setIsModalOpen","editingUser","setEditingUser","isEmailModalOpen","setIsEmailModalOpen","emailSubject","setEmailSubject","emailBody","setEmailBody","isSending","setIsSending","useTranslation","fetchUsers","useCallback","err","console","useEffect","staff","customers","useMemo","filter","handleRowClick","handleCloseModal","handleInputChange","e","name","value","target","prev","_objectSpread","Paper","p","m","display","justifyContent","my","CircularProgress","Alert","severity","_Fragment","Dialog","open","onClose","maxWidth","fullWidth","disableScrollLock","DialogTitle","DialogContent","Grid","container","spacing","item","xs","TextField","disabled","FormControl","InputLabel","Select","onChange","MenuProps","MenuItem","DialogActions","Button","handleOpenEmailModal","toast","success","apiError","autoFocus","margin","type","multiline","rows","subject","message","sendEmailApi","warn"],"ignoreList":[],"sourceRoot":""}