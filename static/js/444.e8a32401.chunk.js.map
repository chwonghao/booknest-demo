{"version":3,"file":"static/js/444.e8a32401.chunk.js","mappings":"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","sources":["api/userApi.js","pages/admin/UserManagementPage.jsx"],"sourcesContent":["// MOCK IMPLEMENTATION\r\n\r\n// Dữ liệu này nên đồng bộ với authApi.js\r\nconst mockUsers = [\r\n    {\r\n        id: 1,\r\n        fullName: \"Người Dùng Demo\",\r\n        email: \"user@example.com\",\r\n        role: \"USER\",\r\n        status: \"ACTIVE\",\r\n        avatar: \"https://i.pravatar.cc/150?u=user@example.com\",\r\n        phoneNumber: \"0123456789\",\r\n        address: \"123 Đường ABC, Quận 1, TP. HCM\"\r\n    },\r\n    {\r\n        id: 2,\r\n        fullName: \"Quản Trị Viên\",\r\n        email: \"admin@example.com\",\r\n        role: \"ADMIN\",\r\n        status: \"ACTIVE\",\r\n        avatar: \"https://i.pravatar.cc/150?u=admin@example.com\",\r\n        phoneNumber: \"0987654321\",\r\n        address: \"456 Đường XYZ, Quận 3, TP. HCM\"\r\n    },\r\n    {\r\n        id: 3,\r\n        fullName: \"Tài Khoản Bị Khóa\",\r\n        email: \"banned@example.com\",\r\n        role: \"USER\",\r\n        status: \"BANNED\",\r\n        avatar: \"https://i.pravatar.cc/150?u=banned@example.com\",\r\n        phoneNumber: \"0111222333\",\r\n        address: \"789 Đường DEF, Quận 5, TP. HCM\"\r\n    }\r\n];\r\n\r\nconst delay = (ms) => new Promise(resolve => setTimeout(resolve, ms));\r\n\r\nexport const getAllUserApi = async () => {\r\n  await delay(500);\r\n  console.log(\"MOCK: getAllUserApi\");\r\n  return [...mockUsers];\r\n};\r\n\r\nexport const updateUserApi = async (userId, payload) => {\r\n  await delay(400);\r\n  console.log(\"MOCK: updateUserApi\", { userId, payload });\r\n  const userIndex = mockUsers.findIndex(u => u.id.toString() === userId.toString());\r\n  if (userIndex > -1) {\r\n    mockUsers[userIndex] = { ...mockUsers[userIndex], ...payload };\r\n    return mockUsers[userIndex];\r\n  }\r\n  throw new Error(\"User not found\");\r\n};","import React, { useEffect, useState, useMemo, useCallback } from 'react';\r\nimport {\r\n  Box,\r\n  Typography,\r\n  Paper,\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableContainer,\r\n  TableHead,\r\n  TableRow,\r\n  CircularProgress,\r\n  Alert,\r\n  Avatar,\r\n  Chip,\r\n  Dialog,\r\n  DialogActions,\r\n  DialogContent,\r\n  DialogTitle,\r\n  TextField,\r\n  Button,\r\n  FormControl,\r\n  InputLabel,\r\n  Select,\r\n  MenuItem,\r\n  Grid,\r\n} from '@mui/material';\r\nimport { toast } from 'react-toastify';\r\nimport { getAllUserApi, updateUserApi } from '../../api/userApi';\r\nimport { sendEmailApi } from '../../api/notificationApi';\r\nimport { useTranslation } from 'react-i18next';\r\n\r\n\r\n// Helper to get initials from name for Avatar\r\nconst getInitials = (name = '') => {\r\n  const initials = name\r\n    .split(' ')\r\n    .map((n) => n[0])\r\n    .join('');\r\n  return initials.toUpperCase();\r\n};\r\n\r\n// Reusable User Table Component\r\nconst UserTable = ({ users, title, onRowClick, t }) => (\r\n  <Box sx={{ mb: 4 }}>\r\n    <Typography variant=\"h5\" gutterBottom component=\"h2\">{title}</Typography>\r\n    <TableContainer>\r\n      <Table stickyHeader>\r\n        <TableHead>\r\n          <TableRow>\r\n            <TableCell sx={{ width: '10%' }}>{t('profile.avatar')}</TableCell>\r\n            <TableCell>{t('register.fullName')}</TableCell>\r\n            <TableCell>{t('register.email')}</TableCell>\r\n            <TableCell align=\"center\">{t('profile.settings')}</TableCell>\r\n            <TableCell>{t('profile.role')}</TableCell>\r\n            <TableCell>{t('productPage.published')}</TableCell>\r\n            <TableCell>{t('admin.dashboardPage.recentLogins')}</TableCell>\r\n          </TableRow>\r\n        </TableHead>\r\n        <TableBody>\r\n          {users.map((user) => (\r\n            <TableRow hover key={user.id} onClick={() => onRowClick(user)} sx={{ cursor: 'pointer' }}>\r\n              <TableCell><Avatar src={user.avatarUrl}>{getInitials(user.fullName)}</Avatar></TableCell>\r\n              <TableCell>{user.fullName}</TableCell>\r\n              <TableCell>{user.email}</TableCell>\r\n              <TableCell align=\"center\"><Chip label={user.status} color={user.status === 'ACTIVE' ? 'success' : 'default'} size=\"small\" /></TableCell>\r\n              <TableCell>\r\n                <Chip label={user.role} color={user.role === 'ADMIN' ? 'secondary' : 'default'} size=\"small\" />\r\n              </TableCell>\r\n              <TableCell>{new Date(user.createdAt).toLocaleDateString()}</TableCell>\r\n              <TableCell>{user.lastLogin ? new Date(user.lastLogin).toLocaleString() : 'N/A'}</TableCell>\r\n            </TableRow>\r\n          ))}\r\n        </TableBody>\r\n      </Table>\r\n    </TableContainer>\r\n    {users.length === 0 && <Typography sx={{ mt: 2, textAlign: 'center' }}>{t('admin.userManagementPage.noUsersInCategory')}</Typography>}\r\n  </Box>\r\n);\r\n\r\nconst UserManagementPage = () => {\r\n  const [users, setUsers] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [editingUser, setEditingUser] = useState(null);\r\n  const [isEmailModalOpen, setIsEmailModalOpen] = useState(false);\r\n  const [emailSubject, setEmailSubject] = useState('');\r\n  const [emailBody, setEmailBody] = useState('');\r\n  const [isSending, setIsSending] = useState(false);\r\n\r\n  const { t } = useTranslation();\r\n\r\n  const fetchUsers = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      const data = await getAllUserApi();\r\n      setUsers(data || []);\r\n    } catch (err) {\r\n      setError(t('admin.userManagementPage.fetchError'));\r\n      setUsers([]);\r\n      console.error(err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [t]);\r\n\r\n  useEffect(() => {\r\n    fetchUsers();\r\n  }, [fetchUsers]);\r\n\r\n  const { staff, customers } = useMemo(() => {\r\n    const staffList = users.filter(user => user.role === 'ADMIN');\r\n    const customerList = users.filter(user => user.role === 'USER');\r\n    return { staff: staffList, customers: customerList };\r\n  }, [users]);\r\n\r\n  const handleRowClick = (user) => {\r\n    setEditingUser(user);\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const handleCloseModal = () => {\r\n    setIsModalOpen(false);\r\n    setEditingUser(null);\r\n    setIsEmailModalOpen(false);\r\n    setEmailSubject(''); setEmailBody('');\r\n  };\r\n\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setEditingUser(prev => ({ ...prev, [name]: value }));\r\n  };\r\n\r\n  const handleSaveUser = async () => {\r\n    if (!editingUser) return;\r\n    try {\r\n      // Chỉ gửi những trường cần thiết để cập nhật\r\n      const { id, role, status } = editingUser;\r\n      await updateUserApi(id, { role, status });\r\n      toast.success(t('admin.userManagementPage.updateSuccess'));\r\n      handleCloseModal();\r\n      fetchUsers(); // Tải lại danh sách người dùng\r\n    } catch (apiError) {\r\n      console.error('Failed to update user:', apiError);\r\n      toast.error(t('admin.userManagementPage.updateError'));\r\n    }\r\n  };\r\n\r\n  const handleOpenEmailModal = () => {\r\n    setIsModalOpen(false); // Đóng modal edit\r\n    setIsEmailModalOpen(true); // Mở modal gửi email\r\n  };\r\n\r\n  const handleSendEmail = async () => {\r\n    if (!editingUser || !emailSubject || !emailBody) {\r\n      toast.warn(t('admin.userManagementPage.emailFormInvalid'));\r\n      return;\r\n    }\r\n    setIsSending(true);\r\n    try {\r\n      const payload = {\r\n        userId: editingUser.id,\r\n        subject: emailSubject,\r\n        message: emailBody,\r\n        type: 'EMAIL', // Thêm loại thông báo là EMAIL\r\n        status: 'PENDING' // Thêm trạng thái ban đầu\r\n      };\r\n      await sendEmailApi(payload);\r\n      toast.success(`${t('admin.userManagementPage.emailSentSuccess')} ${editingUser.fullName}`);\r\n      handleCloseModal(); // Đóng tất cả modal và reset state\r\n    } catch (apiError) {\r\n      console.error('Failed to send email:', apiError);\r\n      toast.error(t('admin.userManagementPage.emailSentError'));\r\n    } finally {\r\n      setIsSending(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Paper sx={{ p: 3, m: 2 }}>\r\n      <Typography variant=\"h4\" gutterBottom>{t('admin.userManagementPage.title')}</Typography>\r\n\r\n      {loading ? (\r\n        <Box sx={{ display: 'flex', justifyContent: 'center', my: 5 }}><CircularProgress /></Box>\r\n      ) : error ? (\r\n        <Alert severity=\"error\">{error}</Alert>\r\n      ) : (\r\n        <>\r\n          <UserTable users={staff} title={t('admin.userManagementPage.staff')} onRowClick={handleRowClick} t={t} />\r\n          <UserTable users={customers} title={t('admin.userManagementPage.customers')} onRowClick={handleRowClick} t={t} />\r\n        </>\r\n      )}\r\n\r\n      {/* Edit User Modal */}\r\n      <Dialog open={isModalOpen} onClose={handleCloseModal} maxWidth=\"sm\" fullWidth disableScrollLock={true}>\r\n        <DialogTitle>{t('admin.userManagementPage.editUser')}</DialogTitle>\r\n        {editingUser && (\r\n          <DialogContent>\r\n            <Grid container spacing={2} sx={{ mt: 1 }}>\r\n              <Grid item xs={12}>\r\n                <TextField fullWidth label={t('register.fullName')} name=\"fullName\" value={editingUser.fullName} disabled />\r\n              </Grid>\r\n              <Grid item xs={12}>\r\n                <TextField fullWidth label={t('register.email')} name=\"email\" value={editingUser.email} disabled />\r\n              </Grid>\r\n              <Grid item xs={12}>\r\n                <FormControl fullWidth>\r\n                  <InputLabel>{t('profile.settings')}</InputLabel>\r\n                  <Select name=\"status\" value={editingUser.status} label={t('profile.settings')} onChange={handleInputChange} MenuProps={{ disableScrollLock: true }}>\r\n                    <MenuItem value=\"ACTIVE\">ACTIVE</MenuItem>\r\n                    <MenuItem value=\"INACTIVE\">INACTIVE</MenuItem>\r\n                    <MenuItem value=\"BANNED\">BANNED</MenuItem>\r\n                  </Select>\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item xs={12}>\r\n                <FormControl fullWidth>\r\n                  <InputLabel>{t('profile.role')}</InputLabel>\r\n                  <Select name=\"role\" value={editingUser.role} label={t('profile.role')} onChange={handleInputChange} MenuProps={{ disableScrollLock: true }}>\r\n                    <MenuItem value=\"USER\">USER</MenuItem>\r\n                    <MenuItem value=\"ADMIN\">ADMIN</MenuItem>\r\n                  </Select>\r\n                </FormControl>\r\n              </Grid>\r\n            </Grid>\r\n          </DialogContent>\r\n        )}\r\n        <DialogActions>\r\n          <Button onClick={handleCloseModal}>{t('action.cancel')}</Button>\r\n          <Button onClick={handleOpenEmailModal} color=\"primary\">{t('admin.userManagementPage.sendEmail')}</Button>\r\n          <Button onClick={handleSaveUser} variant=\"contained\">{t('action.saveChanges')}</Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      {/* Send Email Modal */}\r\n      <Dialog open={isEmailModalOpen} onClose={handleCloseModal} maxWidth=\"md\" fullWidth>\r\n        <DialogTitle>{t('admin.userManagementPage.sendEmailTo')} {editingUser?.fullName}</DialogTitle>\r\n        <DialogContent>\r\n            <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 2 }}>\r\n              {t('register.email')}: {editingUser?.email}\r\n            </Typography>\r\n            <TextField\r\n              autoFocus\r\n              margin=\"dense\"\r\n              id=\"subject\"\r\n              label={t('admin.userManagementPage.emailSubject')}\r\n              type=\"text\"\r\n              fullWidth\r\n              variant=\"outlined\"\r\n              value={emailSubject}\r\n              onChange={(e) => setEmailSubject(e.target.value)}\r\n            />\r\n            <TextField\r\n              margin=\"dense\" id=\"body\" label={t('admin.userManagementPage.emailContent')} type=\"text\" fullWidth multiline rows={8} variant=\"outlined\" value={emailBody} onChange={(e) => setEmailBody(e.target.value)}\r\n            />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleCloseModal}>{t('action.cancel')}</Button>\r\n          <Button onClick={handleSendEmail} variant=\"contained\" disabled={isSending}>{isSending ? t('admin.userManagementPage.sending') : t('admin.userManagementPage.send')}</Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Paper>\r\n  );\r\n};\r\n\r\nexport default UserManagementPage;"],"names":["mockUsers","id","fullName","email","role","status","avatar","phoneNumber","address","delay","ms","Promise","resolve","setTimeout","getAllUserApi","async","console","log","updateUserApi","userId","payload","userIndex","findIndex","u","toString","_objectSpread","Error","getInitials","arguments","length","undefined","split","map","n","join","toUpperCase","UserTable","_ref","users","title","onRowClick","t","_jsxs","Box","sx","mb","children","_jsx","Typography","variant","gutterBottom","component","TableContainer","Table","stickyHeader","TableHead","TableRow","TableCell","width","align","TableBody","user","hover","onClick","cursor","Avatar","src","avatarUrl","Chip","label","color","size","Date","createdAt","toLocaleDateString","lastLogin","toLocaleString","mt","textAlign","UserManagementPage","setUsers","useState","loading","setLoading","error","setError","isModalOpen","setIsModalOpen","editingUser","setEditingUser","isEmailModalOpen","setIsEmailModalOpen","emailSubject","setEmailSubject","emailBody","setEmailBody","isSending","setIsSending","useTranslation","fetchUsers","useCallback","data","err","useEffect","staff","customers","useMemo","filter","handleRowClick","handleCloseModal","handleInputChange","e","name","value","target","prev","Paper","p","m","display","justifyContent","my","CircularProgress","Alert","severity","_Fragment","Dialog","open","onClose","maxWidth","fullWidth","disableScrollLock","DialogTitle","DialogContent","Grid","container","spacing","item","xs","TextField","disabled","FormControl","InputLabel","Select","onChange","MenuProps","MenuItem","DialogActions","Button","handleOpenEmailModal","toast","success","apiError","autoFocus","margin","type","multiline","rows","subject","message","sendEmailApi","concat","warn"],"ignoreList":[],"sourceRoot":""}